### MySql 数据库

#### MySql 版本历史
1. [MySQL前世今生](https://www.jianshu.com/p/9bb6e5690521)
1. MySQL 5.5：10年Oracle收购MySql后推出5.5，InnoDB成默认引擎
1. MySQL 5.6：13年推出，里程碑的版本，生产环境使用最多的
1. MySQL 5.7：15年推出
1. MySQL 8.0：18年推出
1. MariaDB：19年推出10.5，是Mysql的创始人担心MySQL在开源粒度上的下降而开发的（Oracle收购MySql事件）
1. Percona Server：由MySQL咨询公司Percona发布，此公司发布过工具包xtrabackup、percona-toolkit等
1. 从[全球数据库排行](https://db-engines.com/en/ranking)来看，Mysql 远领先于MariaDB和Percona。

#### Mysql事务并发执行遇到的问题
1. 脏写：数据在一个事务中修改未提交，另一个事务把它修改了
1. 脏读：数据在一个事务中修改未提交，另一个事务读到修改后的值
1. 不可重复读：数据在一个事务中修改且提交了，另一个事务再次读能读到最新值。多次读取一条记录，发现结果不一样。
1. 幻读：多次读取一个范围内的记录，发现结果不一样（记录增多或减少也算）。
1. 不可重复读侧重表达读-读，幻读则是读-写，用写来证实读的是鬼影，[幻读，可重复读](https://www.zhihu.com/question/47007926/answer/222348887)

#### Mysql四种隔离级别

|隔离级别	       |脏读	|不可重复读	|幻读|
|  ----  | ----  |  ----  | ----  |
|READ UNCOMMITTED|√  |√ | √ |
|READ COMMITTED  |	 |√ | √ |
|REPEATABLE READ*|	 |  | √ |
|SERIALIZABLE    |	 |  | . |

#### Mysql的查询过程
1. 客户端发送一条查询给服务器； 
1. 服务器先会检查查询缓存，如果命中了缓存，则立即返回存储在缓存中的结果。维护缓存开销太大，从MySQL 5.7.20开始，不推荐使用查询缓存； 
1. 服务器端进行SQL解析、预处理，再由优化器生成对应的执行计划； 
1. MySQL根据优化器生成的执行计划，调用存储引擎的API来执行查询； 
1. 将结果返回给客户端。 

#### char 和 varchar 数据类型区别
1. char：擅于存储经常改变的值，或者长度相对固定的值。比如 type、ip 地址或 md5 之类的数据，不容易产生碎片
1. varchar：善于存储值的长短不一的列，也是用的最多的一种类型，节省磁盘空间，保存可变长度字符串。这也是 innodb 官方推荐的类型

#### InnoDB 和 MyISAM 的区别
1. InnoDB，支持事务，支持行锁，采用 MVCC(并发版本控制) 来支持高并发，实现了四个标准的隔离级别
1. MyISAM，不支持事务和行级锁和外键，select count性能好，写性能差

#### 聚族索引与非聚族索引的区别
1. 聚簇索引的叶子节点就是数据节点，而非聚簇索引的叶子节点是指向数据块的指针
1. innodb 聚簇索引叶子结点保存的是完整数据，innodb 普通索引叶子保存的是记录的主键，myisam 索引叶子保存的是记录的位置 / 偏移量

#### 快照读和当前读有啥区别？幻读的问题怎么解决？

#### int占几个字节，int (3) 和 int (11) 有区别吗？
4个字节，最大范围差不多40亿；没有区别，默认占位的区别

#### 数据库事务的四个特性ACID
1. 原子性（Atomicity），要么都成功，要么都失败
1. 一致性（Consistency），A转账给B，总金额不变
1. 隔离性（Isolation），T1事务不影响T2事务，甚至感觉不到它的存在
1. 持久性（Durability），事务一旦提交就永久保存

#### 时间字段应该选用datetime（mysql>5.6.4）
* [MySQL中的时间字段的几种数据类型比较](https://zhuanlan.zhihu.com/p/75420176)
* 无需任何转换即是人类可读的。
* 不会因为时区变换产生问题。
* 5 字节，只比TIMESTAMP多用 1 字节
* 支持更大的日期范围（到 9999），TIMESTAMP 到 2038

#### binlog 和 redo log 和 undo log
1. [原来MySQL面试还会问这些](https://mp.weixin.qq.com/s/Lx4TNPLQzYaknR7D3gmOmQ)
1. binlog 主从同步/数据恢复，记载的是update/delete/insert这样的SQL语句
1. redo log 为了灾难恢复用，Innode引擎才有，记载的是物理修改的内容（xxxx页修改了xxx）。
1. undo log 为了事务回滚用，如果事务是insert，则记录一条delete供回滚用

#### 怎么往大表中添加字段
1. 建一个空表B，加字段；程序双写A、B表；同步A表数据；ALTER TABLE B RENAME TO A。
1. 使用第三方工具，[mysql在线修改表结构大数据表的风险与解决办法归纳](https://www.cnblogs.com/wangtao_20/p/3504395.html)

#### 大表的limit查询优化
1. [mysql 近千万级数据表，在分页时有什么好的方案吗](https://v2ex.com/t/661755)

